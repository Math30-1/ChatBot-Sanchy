<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Admin</title>

    <!-- CSS EXCLUSIVO DO ADMIN -->
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
</head>
<body>

<div class="admin-container">

    <a href="{{ url_for('logout') }}" class="logout-link">Sair</a>

    <h2 class="admin-title">Painel de AdministraÃ§Ã£o</h2>
    <hr>

    <!-- =======================
         FORMULÃRIO 1: ATENDENTE
    ======================== -->
    <h3 class="admin-subtitle">âž• Cadastrar Atendente</h3>

    <form method="post" class="admin-form">
        <input type="hidden" name="acao" value="adicionar_atendente">

        <label>Nome do atendente:</label>
        <input type="text" name="nome" required>

        <label>WhatsApp (com DDI):</label>
        <input type="text" name="whatsapp" required>

        <button type="submit" class="admin-btn">Cadastrar Atendente</button>
    </form>

    <hr>

    <!-- =======================
         FORMULÃRIO 2: SERVIÃ‡OS
    ======================== -->
    <h3 class="admin-subtitle">ðŸ›  Cadastrar ServiÃ§o</h3>

    <form method="post" class="admin-form">
        <input type="hidden" name="acao" value="adicionar_servico">

        <label>Nome do ServiÃ§o / Pergunta:</label>
        <input type="text" name="pergunta" required>

        <label>Selecione o Atendente:</label>
        <select name="nome" required>
            {% for key, item in opcoes.items() %}
                <option value="{{ key }}">{{ key }}</option>
            {% endfor %}
        </select>

        <label>Mensagem inicial:</label>
        <input type="text" name="mensagem" required>

        <button type="submit" class="admin-btn">Cadastrar ServiÃ§o</button>
    </form>

    <hr>

    <!-- =======================
         LISTA DE SERVIÃ‡OS
    ======================== -->
    <h3 class="admin-subtitle">ðŸ“‹ ServiÃ§os cadastrados</h3>

    <ul class="service-list">
        {% for pergunta, dados in opcoes.items() %}
            {% if dados.mensagem %}
            <li class="service-item">

                <span><strong>{{ pergunta }}</strong> â†’ {{ dados.nome }} ({{ dados.whatsapp }})</span>

                <div style="display:flex; gap:8px;">
                    <button type="button" class="admin-btn" onclick="mostrarFormulario('{{ pergunta }}')">
                        Editar
                    </button>

                    <form method="post">
                        <input type="hidden" name="acao" value="remover">
                        <input type="hidden" name="pergunta" value="{{ pergunta }}">
                        <button type="submit" class="remove-btn">Remover</button>
                    </form>
                </div>

                <!-- FORMULÃRIO DE EDIÃ‡ÃƒO -->
                <form method="post" id="form-{{ pergunta }}" class="admin-form"
                      style="display:none; margin-top:15px;">

                    <input type="hidden" name="acao" value="editar">
                    <input type="hidden" name="pergunta_original" value="{{ pergunta }}">

                    <label>Nova pergunta:</label>
                    <input type="text" name="nova_pergunta" value="{{ pergunta }}" required>

                    <label>Nome do atendente:</label>
                    <input type="text" name="nome" value="{{ dados.nome }}" required>

                    <label>WhatsApp:</label>
                    <input type="text" name="whatsapp" value="{{ dados.whatsapp }}" required>

                    <label>Mensagem inicial:</label>
                    <input type="text" name="mensagem" value="{{ dados.mensagem }}" required>

                    <button type="submit" class="admin-btn">Salvar alteraÃ§Ãµes</button>
                </form>

            </li>
            {% endif %}
        {% endfor %}
    </ul>

</div>

<!-- SCRIPT INCORPORADO -->
<script>
function mostrarFormulario(id) {
    const f = document.getElementById("form-" + id);
    f.style.display = f.style.display === "none" ? "block" : "none";
}
</script>

</body>
</html>
